<div class="victim-dashboard">
  <div class="page-header">
    <h1>Emergency Request Status</h1>
    <p class="subtitle">Track your emergency request and communicate with rescue teams</p>
  </div>

  <div class="dashboard-content">
    <!-- Main Content Area -->
    <div class="main-content">
      <!-- Request Status Card -->
      <mat-card class="status-card" *ngIf="requestObject">
        <mat-card-header>
          <div class="card-header-content">
            <mat-icon class="header-icon">emergency</mat-icon>
            <div>
              <mat-card-title>Your Emergency Request</mat-card-title>
              <mat-card-subtitle>Request ID: #{{requestInfo?.requestId || 'N/A'}}</mat-card-subtitle>
            </div>
          </div>
        </mat-card-header>
        <mat-card-content>
          <div class="status-info">
            <div class="info-item">
              <mat-icon>place</mat-icon>
              <div>
                <span class="info-label">Location</span>
                <span class="info-value">{{requestObject.location || 'Not specified'}}</span>
              </div>
            </div>
            <div class="info-item">
              <mat-icon>access_time</mat-icon>
              <div>
                <span class="info-label">Status</span>
                <span class="info-value status-badge">{{requestObject.status || 'Pending'}}</span>
              </div>
            </div>
          </div>
        </mat-card-content>
      </mat-card>

      <!-- Messages Card -->
      <mat-card class="messages-card">
        <mat-card-header>
          <div class="card-header-content">
            <mat-icon class="header-icon">forum</mat-icon>
            <mat-card-title>Messages from Rescue Team</mat-card-title>
          </div>
          <button mat-raised-button color="primary" (click)="openChatLobby()">
            <mat-icon>chat</mat-icon>
            Open Chat
          </button>
        </mat-card-header>
        <mat-card-content>
          <div *ngIf="allMessages.length === 0" class="empty-state">
            <mat-icon>inbox</mat-icon>
            <p>No messages yet</p>
            <span>You'll receive updates here when the rescue team contacts you</span>
          </div>

          <table mat-table [dataSource]="allMessages" class="messages-table" *ngIf="allMessages.length > 0">
            <ng-container matColumnDef="sender">
              <th mat-header-cell *matHeaderCellDef>From</th>
              <td mat-cell *matCellDef="let element">
                <div class="sender-cell">
                  <mat-icon>person</mat-icon>
                  <span>{{element.sender || 'Rescue Team'}}</span>
                </div>
              </td>
            </ng-container>

            <ng-container matColumnDef="content">
              <th mat-header-cell *matHeaderCellDef>Message</th>
              <td mat-cell *matCellDef="let element">
                <span class="message-content">{{element.content}}</span>
              </td>
            </ng-container>

            <ng-container matColumnDef="timestamp">
              <th mat-header-cell *matHeaderCellDef>Time</th>
              <td mat-cell *matCellDef="let element">
                <span class="timestamp">{{element.timestamp | date:'short'}}</span>
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
          </table>
        </mat-card-content>
      </mat-card>
    </div>

    <!-- Sidebar -->
    <div class="sidebar-panel">
      <!-- Rescue Team Info Card -->
      <mat-card class="team-card" *ngIf="rescueTeamObject.length > 0">
        <mat-card-header>
          <div class="card-header-content">
            <mat-icon class="header-icon">groups</mat-icon>
            <mat-card-title>Assigned Rescue Team</mat-card-title>
          </div>
        </mat-card-header>
        <mat-card-content>
          <div *ngFor="let team of rescueTeamObject" class="team-info">
            <div class="team-detail">
              <mat-icon>badge</mat-icon>
              <div>
                <span class="detail-label">Team ID</span>
                <span class="detail-value">{{team.rescueTeamId}}</span>
              </div>
            </div>
            <div class="team-detail">
              <mat-icon>people</mat-icon>
              <div>
                <span class="detail-label">Members</span>
                <span class="detail-value">{{team.members || 'N/A'}}</span>
              </div>
            </div>
            <div class="team-detail">
              <mat-icon>location_on</mat-icon>
              <div>
                <span class="detail-label">Current Location</span>
                <span class="detail-value">{{team.currentLocation || 'Updating...'}}</span>
              </div>
            </div>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="team-card" *ngIf="rescueTeamObject.length === 0">
        <mat-card-header>
          <div class="card-header-content">
            <mat-icon class="header-icon">info</mat-icon>
            <mat-card-title>Rescue Team Status</mat-card-title>
          </div>
        </mat-card-header>
        <mat-card-content>
          <div class="empty-state">
            <mat-icon>hourglass_empty</mat-icon>
            <p>Waiting for team assignment</p>
            <span>A rescue team will be assigned to your request shortly</span>
          </div>
        </mat-card-content>
      </mat-card>

      <!-- Quick Actions Card -->
      <mat-card class="actions-card">
        <mat-card-header>
          <mat-card-title>Quick Actions</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="action-buttons">
            <button mat-raised-button color="primary" (click)="openChatLobby()" class="action-btn">
              <mat-icon>chat</mat-icon>
              <span>Chat with Team</span>
            </button>
            <button mat-raised-button (click)="openAllMessages()" class="action-btn">
              <mat-icon>forum</mat-icon>
              <span>View All Messages</span>
            </button>
          </div>
        </mat-card-content>
      </mat-card>
    </div>
  </div>
</div>

<!--
  <mat-card class="example-card">
    <mat-card-header>
      <div mat-card-avatar class="example-header-image"></div>
      <mat-card-title>All Messages</mat-card-title>
    </mat-card-header>
    <mat-card-content>

        <table mat-table [dataSource]="allMessages" class="mat-elevation-z8">




            <ng-container matColumnDef="sender">
              <th mat-header-cell *matHeaderCellDef> Sender </th>
              <td mat-cell *matCellDef="let element"> {{element.sender}} </td>
            </ng-container>


            <ng-container matColumnDef="content">
              <th mat-header-cell *matHeaderCellDef> Content </th>
              <td mat-cell *matCellDef="let element"> {{element.content}} </td>
            </ng-container>


            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>



          </table>

    </mat-card-content>
    <mat-card-actions>
      <button mat-button>LIKE</button>
      <button mat-button>SHARE</button>
    </mat-card-actions>
  </mat-card>

  -->
